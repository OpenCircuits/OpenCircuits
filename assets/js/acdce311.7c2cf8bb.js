"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[385],{5134:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"Introduction/Guides/AddingNewComponents","title":"Adding new Components","description":"Each component has at least two SVG files to display. One of these is the one shown in the item navigation bar where you drag components from, and the other(s) are shown on the canvas when dragged and dropped.","source":"@site/../../../../docs/Introduction/Guides/AddingNewComponents.md","sourceDirName":"Introduction/Guides","slug":"/Introduction/Guides/AddingNewComponents","permalink":"/Introduction/Guides/AddingNewComponents","draft":false,"unlisted":false,"editUrl":"https://github.com/OpenCircuits/OpenCircuits/edit/master/docs/Introduction/Guides/AddingNewComponents.md","tags":[],"version":"current","frontMatter":{"title":"Adding new Components"},"sidebar":"introSidebar","previous":{"title":"Running","permalink":"/Introduction/GettingStarted/Running"},"next":{"title":"Cheat Sheets","permalink":"/Introduction/Guides/CheatSheets"}}');var o=t(2295),s=t(8002);const i={title:"Adding new Components"},c=void 0,l={},a=[{value:"Itemnav SVG file",id:"itemnav-svg-file",level:2},{value:"Canvas SVG file(s)",id:"canvas-svg-files",level:2},{value:"TypeScript files",id:"typescript-files",level:2},{value:"Checklist",id:"checklist",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",input:"input",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"Each component has at least two SVG files to display. One of these is the one shown in the item navigation bar where you drag components from, and the other(s) are shown on the canvas when dragged and dropped."}),"\n",(0,o.jsx)(n.h2,{id:"itemnav-svg-file",children:"Itemnav SVG file"}),"\n",(0,o.jsx)(n.p,{children:"The itemnav SVG looks like this:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-svg",children:'<?xml version="1.0" encoding="UTF-8"?>\r\n<svg xmlns="http://www.w3.org/2000/svg" width="60" height="30">\r\n<path d=" INPUT PATH HERE "\r\nstroke="black" stroke-width="1" stroke-linecap="round" fill="none"></path>\r\n</svg>\n'})}),"\n",(0,o.jsxs)(n.p,{children:["I like to use ",(0,o.jsx)(n.a,{href:"https://www.rapidtables.com/web/tools/svg-viewer-editor.html",children:"this editor/viewer from rapidtables"})," because it is straightforward unlike a lot of other SVG editors out there. Copy the code above into there and modify ",(0,o.jsx)(n.code,{children:"INPUT PATH HERE"})," to be the actual path (",(0,o.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths",children:"read up on paths here"}),"). Some icons require more than just a path (i.e. circles and other neat shapes). You can edit these however you like, this is just some starter code."]}),"\n",(0,o.jsx)(n.p,{children:"Put your itemnav SVG file into the  site/public/img/icons folder, where you will see additional subfolders for each category of component."}),"\n",(0,o.jsxs)(n.p,{children:["Additionally, you'll need to add your component as an object in digitalnavconfig.json file. The ",(0,o.jsx)(n.code,{children:'"id"'})," field should be the same ",(0,o.jsx)(n.code,{children:'"id"'})," used in the ",(0,o.jsx)(n.code,{children:"@serializable"})," tag in ",(0,o.jsx)(n.code,{children:"YourComponentName.ts"}),". The ",(0,o.jsx)(n.code,{children:'"label"'})," field is what is shown underneath the component in the itemnav, and in the ",(0,o.jsx)(n.code,{children:'"icon"'})," field you should put the path to your itemnav SVG file name."]}),"\n",(0,o.jsx)(n.h2,{id:"canvas-svg-files",children:"Canvas SVG file(s)"}),"\n",(0,o.jsxs)(n.p,{children:["If your component is ",(0,o.jsx)(n.code,{children:"Pressable"}),", which means you should be able to click on it to change its behavior (e.g. a switch or button), then you will need to create multiple SVG files. If not, then only one is required. These are similar to the itemnav SVG files:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-svg",children:'<?xml version="1.0" encoding="UTF-8"?>\r\n<svg xmlns="http://www.w3.org/2000/svg" width="30px" height="10.5px" viewbox = "24 9.75 17 10.5">\r\n<path d=" INPUT PATH HERE "\r\nstroke="black" stroke-width="1" stroke-linecap="round" fill="none"></path>\r\n</svg>\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Your path and dimensions may vary from the itemnav tool. When in doubt, take a look at existing component SVGs as examples. The main difference here is the ",(0,o.jsx)(n.code,{children:"viewBox"})," which defines the area of the icon which is to be visible. The height and width should be at least the same ratio as those defined in your component's TypeScript file, which we will get to later."]}),"\n",(0,o.jsxs)(n.p,{children:["Make it in site/public/img/items. Next, add your canvas SVG file name(s) to a variable called ",(0,o.jsx)(n.code,{children:"IMAGE_FILE_NAMES"})," in app/digital/ts/utils/Images.ts ."]}),"\n",(0,o.jsx)(n.h2,{id:"typescript-files",children:"TypeScript files"}),"\n",(0,o.jsxs)(n.p,{children:["First create a new ",(0,o.jsx)(n.code,{children:"YourComponentName.ts"})," file in the app/digital/ts/models/ioobjects . Implement the class in the TypeScript file. It's easiest to follow the example of an existing component, but here's what it should look like."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'@serializable("YourComponentID") // <- this must be the same "id" as in digital navconfig.json\r\nexport class YourComponent extends DigitalComponent {\r\n    public constructor( /* arguments */ ) {\r\n        super(new ClampedValue(NUMBER OF PORTS), V(WIDTH, HEIGHT));\r\n         // more code ...\r\n    }\r\n\r\n    public getDisplayName(): string {\r\n        return "YourComponentName";\r\n    }\r\n\r\n    // name of the canvas icon, not the itemnav svg\r\n    public getImageName(): string {\r\n        return "yourcomponent.svg";\r\n    }\r\n\r\n    // other necessary methods ...\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Add this component to a list of ",(0,o.jsx)(n.code,{children:"export"}),"s in the app/digital/ts/models/ioobjects/index.ts ."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'export {YourComponent} from "./YourComponent";\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Second create any actions yor component might need in app/digital/actions/. Here is an example from\r\n",(0,o.jsx)(n.code,{children:"ClockFrequencyChangeAction.ts"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"export class ClockFrequencyChangeAction implements Action {\r\n    private clock: Clock;\r\n\r\n    private initialFreq: number;\r\n    private targetFreq: number;\r\n\r\n    public constructor(clock: Clock, targetFreq: number) {\r\n        this.clock = clock;\r\n\r\n        this.initialFreq = clock.getFrequency();\r\n        this.targetFreq = targetFreq;\r\n    }\r\n\r\n    public execute(): Action {\r\n        this.clock.setFrequency(this.targetFreq);\r\n\r\n        return this;\r\n    }\r\n\r\n    public undo(): Action {\r\n        this.clock.setFrequency(this.initialFreq);\r\n\r\n        return this;\r\n    }\r\n\r\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Third create any SelectionPopupModules your component needs in site/pages/digital/src/containers/SelectionPopup/modules/. Here is\r\nan example from ",(0,o.jsx)(n.code,{children:"OutputCountModule.tsx"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'const Config: ModuleConfig<[Encoder], number> = {\r\n    types: [Encoder],\r\n    valType: "int",\r\n    getProps: (o) => o.getOutputPortCount().getValue(),\r\n    getAction: (s, newCount) => new GroupAction(s.map(o =>\r\n        new CoderPortChangeAction(o, o.getOutputPortCount().getValue(), newCount)))\r\n}\r\n\r\nexport const OutputCountModule = PopupModule({\r\n    label: "Output Count",\r\n    modules: [CreateModule({\r\n        inputType: "number",\r\n        config: Config,\r\n        step: 1, min: 2, max: 8,\r\n        alt: "Number of outputs object(s) have"\r\n    })]\r\n});\n'})}),"\n",(0,o.jsx)(n.p,{children:"Add your new PopupModules to src/site/pages/digital/src/containers/App/index.tsx\r\n(around line 114)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"modules={[PositionModule, InputCountModule,\r\n        SelectPortCountModule,\r\n        DecoderInputCountModule,\r\n        OutputCountModule, SegmentCountModule,\r\n        ClockFrequencyModule,\r\n        ColorModule, TextColorModule,\r\n        BusButtonModule, CreateICButtonModule,\r\n        ViewICButtonModule, ClockSyncButtonModule, \r\n        YourModuleHere]} />\r\n\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Lastly create any custom renderers your component needs in app/digital/rendering/ioobjects/FOLDER/YOUR_RENDERER.ts .\r\nHere is\r\nan example from ",(0,o.jsx)(n.code,{children:"ConstantNumberRenderer.ts"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'export const ConstantNumberRenderer = (() => {\r\n\r\n    // Function to draw the line connecting the 4 outputs\r\n    const drawOutputConnector = function(renderer: Renderer, size: Vector, borderColor: string): void {\r\n        const style = new Style(undefined, borderColor, DEFAULT_BORDER_WIDTH);\r\n        // Y coordinates of the top and bottom\r\n        const l1 = -(size.y/2)*(1.5);\r\n        const l2 =  (size.y/2)*(1.5);\r\n        // X coordinate to draw the vertical line\r\n        const s = (size.x-DEFAULT_BORDER_WIDTH)/2;\r\n        renderer.draw(new Line(V(s, l1), V(s, l2)), style);\r\n    }\r\n\r\n    // Function to draw the input value on the component\r\n    const drawInputText = function(renderer: Renderer, value: number): void {\r\n        const text = value < 10 ? value.toString() : "ABCDEF".charAt(value - 10);\r\n        renderer.text(text, V(0, 2.5), "center", DEFAULT_ON_COLOR, FONT_CONSTANT_NUMBER);\r\n    }\r\n\r\n    return {\r\n        render(renderer: Renderer, object: ConstantNumber, selected: boolean): void {\r\n            const transform = object.getTransform();\r\n            const fillColor = selected ? SELECTED_FILL_COLOR : DEFAULT_FILL_COLOR;\r\n\r\n            const borderColor = selected ? SELECTED_BORDER_COLOR : DEFAULT_BORDER_COLOR;\r\n            const style = new Style(fillColor, borderColor, DEFAULT_BORDER_WIDTH);\r\n\r\n            // Draw the rectangle first, subtracting border width for alignment\r\n            const rectSize = transform.getSize().sub(DEFAULT_BORDER_WIDTH);\r\n            renderer.draw(new Rectangle(V(), rectSize), style);\r\n\r\n            // Connect the output lines together and draw the text\r\n            drawOutputConnector(renderer, transform.getSize(), borderColor);\r\n            drawInputText(renderer, object.getInputNum());\r\n        }\r\n    };\r\n})();\n'})}),"\n",(0,o.jsx)(n.p,{children:"To add your custom render go to src/app/digital/rendering/ioobjects/ComponentRenderer.ts\r\nchange the following code to add your custom render"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"    if (object instanceof Gate)\r\n        GateRenderer.render(renderer, camera, object, selected);\r\n    else if (object instanceof Multiplexer || object instanceof Demultiplexer)\r\n        MultiplexerRenderer.render(renderer, camera, object, selected);\r\n    else if (object instanceof SegmentDisplay)\r\n        SegmentDisplayRenderer.render(renderer, camera, object, selected);\r\n    else if (object instanceof IC)\r\n        ICRenderer.render(renderer, camera, object, selected);\r\n    else if (object instanceof FlipFlop || object instanceof Latch)\r\n        drawBox(renderer, transform, selected);\r\n    else if (object instanceof Encoder || object instanceof Decoder)\r\n        drawBox(renderer, transform, selected);\r\n    else if (object instanceof Your_Component)\r\n        Your_ComponentRenderer.render(renderer, camera, object, selected);\n"})}),"\n",(0,o.jsx)(n.h2,{id:"checklist",children:"Checklist"}),"\n",(0,o.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,o.jsxs)(n.li,{className:"task-list-item",children:[(0,o.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Itemnav SVG in icons folder"]}),"\n",(0,o.jsxs)(n.li,{className:"task-list-item",children:[(0,o.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Canvas SVG(s) in items folder"]}),"\n",(0,o.jsxs)(n.li,{className:"task-list-item",children:[(0,o.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Add object to digitalnavconfig.json"]}),"\n",(0,o.jsxs)(n.li,{className:"task-list-item",children:[(0,o.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Update ",(0,o.jsx)(n.code,{children:"IMAGE_FILE_NAMES"})," in Images.ts"]}),"\n",(0,o.jsxs)(n.li,{className:"task-list-item",children:[(0,o.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Create TypeScript file"]}),"\n",(0,o.jsxs)(n.li,{className:"task-list-item",children:[(0,o.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Add export in index.ts"]}),"\n",(0,o.jsxs)(n.li,{className:"task-list-item",children:[(0,o.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Create new actions"]}),"\n",(0,o.jsxs)(n.li,{className:"task-list-item",children:[(0,o.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Create SelectionPopupModules"]}),"\n",(0,o.jsxs)(n.li,{className:"task-list-item",children:[(0,o.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Add your SelectionPopupModules in index.tsx"]}),"\n",(0,o.jsxs)(n.li,{className:"task-list-item",children:[(0,o.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Create custom renderers"]}),"\n",(0,o.jsxs)(n.li,{className:"task-list-item",children:[(0,o.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Add your custom renderers in ComponentRenderer.ts"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8002:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>c});var r=t(8431);const o={},s=r.createContext(o);function i(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);